<!DOCTYPE html><html lang="zh-Hans"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="JS大数运算与精度"><meta name="keywords" content="es6,原生"><meta name="author" content="JaCo Wu"><meta name="copyright" content="JaCo Wu"><title>JS大数运算与精度 | JaCo Wu的博客</title><link rel="shortcut icon" href="https://jacokwu.cn/images/public/author.jpg"><link rel="stylesheet" href="/blog/css/index.css?version=1.6.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.6.1"><link rel="dns-prefetch" href="https://cdn.staticfile.org"><link rel="dns-prefetch" href="https://cdn.bootcss.com"><link rel="dns-prefetch" href="https://creativecommons.org"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css"><script src="https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js"></script><script src="https://cdn.jsdelivr.net/npm/blueimp-md5@2.10.0/js/md5.min.js"></script><link rel="dns-prefetch" href="http://ta.qq.com"><script>(function() {
   var hm = document.createElement("script");
   hm.src = "https://tajs.qq.com/stats?sId=66455669";
   var s = document.getElementsByTagName("script")[0];
   s.parentNode.insertBefore(hm, s);
 })();</script><script>var GLOBAL_CONFIG = { 
  root: '/blog/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容:${query}"}},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  }
} </script></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="toggle-sidebar-info text-center"><span data-toggle="切换文章详情">切换站点概览</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#起因"><span class="toc-number">1.</span> <span class="toc-text">起因</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#过程"><span class="toc-number">2.</span> <span class="toc-text">过程</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#精度问题"><span class="toc-number">2.1.</span> <span class="toc-text">精度问题</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#大数精度"><span class="toc-number">2.1.1.</span> <span class="toc-text">大数精度</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#toFixed"><span class="toc-number">2.1.2.</span> <span class="toc-text">toFixed()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#浮点数加减"><span class="toc-number">2.1.3.</span> <span class="toc-text">浮点数加减</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#大数运算（浮点数运算）"><span class="toc-number">2.2.</span> <span class="toc-text">大数运算（浮点数运算）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#大数加法"><span class="toc-number">2.2.1.</span> <span class="toc-text">大数加法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#符号及NaN"><span class="toc-number">2.2.1.1.</span> <span class="toc-text">符号及NaN</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#核心计算过程"><span class="toc-number">2.2.1.2.</span> <span class="toc-text">核心计算过程</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#大数减法"><span class="toc-number">2.2.2.</span> <span class="toc-text">大数减法</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#总结"><span class="toc-number">3.</span> <span class="toc-text">总结</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#参考"><span class="toc-number">4.</span> <span class="toc-text">参考</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#源码"><span class="toc-number">5.</span> <span class="toc-text">源码</span></a></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="https://jacokwu.cn/images/public/author.jpg"></div><div class="author-info__name text-center">JaCo Wu</div><div class="author-info__description text-center">一个默默无闻的前端攻城狮</div><div class="follow-button"><a href="https://github.com/JaCoxxx/JaCoxxx.github.io">Follow Me</a></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/blog/archives"><span class="pull-left">文章</span><span class="pull-right">26</span></a><a class="author-info-articles__tags article-meta" href="/blog/tags"><span class="pull-left">标签</span><span class="pull-right">35</span></a><a class="author-info-articles__categories article-meta" href="/blog/categories"><span class="pull-left">分类</span><span class="pull-right">8</span></a></div><hr><div class="author-info-links"><div class="author-info-links__title text-center">大佬博客</div><a class="author-info-links__name text-center" href="http://www.wclimb.site">wclimb</a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://jacokwu.cn/images/public/background.png)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/blog/">JaCo Wu的博客</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page social-icon search"><i class="fa fa-search"></i><span> 搜索</span></a><a class="site-page" href="/blog">首页</a><a class="site-page" href="/blog/archives">归档</a><a class="site-page" href="/blog/tags">标签</a><a class="site-page" href="/blog/gallery">相册</a><a class="site-page" href="/blog/categories">分类</a></span></div><div id="post-info"><div id="post-title">JS大数运算与精度</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-06-13</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/blog/categories/js/">js</a><div class="post-meta-wordcount"><span>字数总计: </span><span class="word-count">3.9k</span><span class="post-meta__separator">|</span><span>阅读时长: 15 分钟</span></div></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><h1 id="起因"><a href="#起因" class="headerlink" title="起因"></a>起因</h1><p>最近在项目上涉及到大数的展示，不仅是个大数，还是个小数。然后我们对数字进行验证的时候，发现数字太大了，前端这边根本无法算出正确的结果，而且小数部分还存在精度误差问题。这时候想到了利用 <a href="https://github.com/MikeMcl/bignumber.js/" target="_blank" rel="noopener">bignumber.js</a> 来解决这个问题；但是我们的系统已经基本进入了后期优化阶段，因为各种原因，这个时候再引入一个新的库有些得不偿失，而且用到的地方就这一个(其他涉及到数字的地方都有专门的方案用来解决精度问题，但是无法解决大数的问题)。所以我就想写个方法专门用来解决这个地方的精度问题以及计算问题。</p>
<h1 id="过程"><a href="#过程" class="headerlink" title="过程"></a>过程</h1><h2 id="精度问题"><a href="#精度问题" class="headerlink" title="精度问题"></a>精度问题</h2><p>造成精度丢失的原因目前我见过的常见的可能有以下几种：</p>
<ol>
<li>后台传过来的就是浮点型，数字太大了，在传输到显示的过程中，哪怕不加任何运算，精度也会丢失;</li>
<li><code>toFixed()</code>方法造成的精度丢失;</li>
<li>浮点数加减法造成的精度丢失。</li>
</ol>
<p>下面我们来分别讨论下这三种问题产生的原因以及解决方法。</p>
<h3 id="大数精度"><a href="#大数精度" class="headerlink" title="大数精度"></a>大数精度</h3><p>我们发现在js中，数字一旦超过安全值，就开始变得不再精准，哪怕是简单的加法运算。产生这种问题的原因是js采用的是 IEEE 754 即IEEE二进制浮点数算术标准中的双精度浮点数。何为 IEEE 754？网上已经又很多详细的解释了，这里不再赘述。</p>
<p>js的安全值范围是(-9007199254740991 ~ 9007199254740991)。也就是 <code>-(Math.pow(2, 53) - 1) ~ (Math.pow(2, 53) - 1)</code>。为了避免超出安全值范围导致精度丢失，只需要让后端传String类型即可。</p>
<h3 id="toFixed"><a href="#toFixed" class="headerlink" title="toFixed()"></a>toFixed()</h3><p>我们先看以下几个toFixed结果。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">(<span class="number">1.345</span>).toFixed(<span class="number">2</span>) <span class="comment">// 1.34 -- 错误</span></span><br><span class="line">(<span class="number">1.375</span>).toFixed(<span class="number">2</span>) <span class="comment">// 1.38 -- 正确</span></span><br><span class="line">(<span class="number">1.666</span>).toFixed(<span class="number">2</span>) <span class="comment">// 1.67 -- 正确</span></span><br><span class="line">(<span class="number">1.636</span>).toFixed(<span class="number">2</span>) <span class="comment">// 1.64 -- 正确</span></span><br><span class="line">(<span class="number">1.423</span>).toFixed(<span class="number">2</span>) <span class="comment">// 1.42 -- 正确</span></span><br><span class="line">(<span class="number">1.483</span>).toFixed(<span class="number">2</span>) <span class="comment">// 1.48 -- 正确</span></span><br></pre></td></tr></table></figure>

<p>经过几次试探，我们发现<code>x.toFixed(f)</code>偶尔会发生精度丢失的问题。<br>现在看看为什么会出现这样的问题。研究了一下<a href="https://www.ecma-international.org/ecma-262/6.0/#sec-number.prototype.tofixed" target="_blank" rel="noopener">ECMA 262</a>中对<code>Number.prototype.toFixed9(fractionDigits)</code>指定的规则。纯英文的，我就不翻译了。涉及到精度的步骤大概是下面这样。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// (1.345).toFixed(2)</span></span><br><span class="line"><span class="comment">// 步骤10.a</span></span><br><span class="line"><span class="number">134</span> / <span class="built_in">Math</span>.pow(<span class="number">10</span>, <span class="number">2</span>) - <span class="number">1.345</span> <span class="comment">// -0.004999999999999893</span></span><br><span class="line"><span class="number">135</span> / <span class="built_in">Math</span>.pow(<span class="number">10</span>, <span class="number">2</span>) - <span class="number">1.345</span> <span class="comment">// 0.0050000000000001155</span></span><br><span class="line"><span class="comment">// 我们取最接近0的值为 -0.004999999999999893，然后根据步骤10.c得到值为 1.34</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// (1.375).toFixed(2)</span></span><br><span class="line"><span class="comment">// 步骤10.a</span></span><br><span class="line"><span class="number">137</span> / <span class="built_in">Math</span>.pow(<span class="number">10</span>, <span class="number">2</span>) - <span class="number">1.375</span> <span class="comment">// -0.004999999999999893</span></span><br><span class="line"><span class="number">138</span> / <span class="built_in">Math</span>.pow(<span class="number">10</span>, <span class="number">2</span>) - <span class="number">1.375</span> <span class="comment">// 0.004999999999999893</span></span><br><span class="line"><span class="comment">// 两个值的绝对值大小相同，所以我们取较大的值 0.004999999999999893，然后根据步骤10.c得到值为 1.38</span></span><br></pre></td></tr></table></figure>

<p><strong>*为什么1.345对应的步骤10.a要用134和135？</strong></p>
<p>在规范中没有解释这个n的来源，我根据上下文理解应该是 <code>n = (x * Math.pow(10, f)).toString().split(&#39;.&#39;)[0]</code>，其中x为原值，f为参数；然后又因为四舍五入只可能为当前值或者当前值加1，所以用的是134和135。</p>
<p>显然，根据内部的运算规则，toFixed的精度丢失是不可避免的，所以我们可以通过重写toFixed方法来解决这个问题。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 未优化</span></span><br><span class="line"><span class="built_in">Number</span>.prototype.toFixed = <span class="function"><span class="keyword">function</span> (<span class="params">f</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> params = <span class="built_in">Number</span>(f)</span><br><span class="line">    <span class="keyword">const</span> num = <span class="keyword">this</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">isNaN</span>(num)) <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;num&#125;</span>`</span> <span class="comment">// 处理NaN返回</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">isNaN</span>(params)) params = <span class="number">0</span> <span class="comment">// 处理参数NaN情况</span></span><br><span class="line">    <span class="keyword">if</span> (params &gt; <span class="number">100</span> || params &lt; <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">RangeError</span>(<span class="string">'toFixed() digits argument must be between 0 and 100'</span>) <span class="comment">// 处理参数大小问题</span></span><br><span class="line">    <span class="keyword">let</span> temp = num * <span class="built_in">Math</span>.pow(<span class="number">10</span>, params) <span class="comment">//  这里是为了使得需要保留的放在整数位，需要舍去的放在小数位</span></span><br><span class="line">    <span class="keyword">const</span> tempInteger = temp.toString().split(<span class="string">'.'</span>)[<span class="number">0</span>] <span class="comment">// temp的整数位</span></span><br><span class="line">    <span class="keyword">const</span> judgeInteger = (temp + <span class="number">0.5</span>).toString().split(<span class="string">'.'</span>)[<span class="number">0</span>] <span class="comment">// temp + 0.5的整数位</span></span><br><span class="line">    <span class="keyword">const</span> tempArr = tempInteger.split(<span class="string">''</span>)</span><br><span class="line">    tempArr.splice(tempArr.length - f, <span class="number">0</span>, <span class="string">'.'</span>)</span><br><span class="line">    <span class="keyword">const</span> judgeArr = judgeInteger.split(<span class="string">''</span>)</span><br><span class="line">    judgeArr.splice(judgeArr.length - f, <span class="number">0</span>, <span class="string">'.'</span>)</span><br><span class="line">    <span class="comment">// 判断temp + 0.5之后是否大于temp，大于则说明尾数需要进位，相等则代表不需要</span></span><br><span class="line">    <span class="keyword">return</span> judgeInteger &gt; tempInteger ? <span class="string">`<span class="subst">$&#123;judgeArr.join(<span class="string">''</span>)&#125;</span>`</span> : <span class="string">`<span class="subst">$&#123;tempArr.join(<span class="string">''</span>)&#125;</span>`</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="浮点数加减"><a href="#浮点数加减" class="headerlink" title="浮点数加减"></a>浮点数加减</h3><p>我们经常会遇到这种问题，<code>0.1 + 0.2 !== 0.3</code>。这是因为js在运算的时候会先把数字转换为二进制，但是一些小数转为二进制是无限循环的，所以会造成结果的误差。看以下代码。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">(<span class="number">0.1</span>).toString(<span class="number">2</span>)       <span class="comment">// 0.0001 1001 1001 1001 1001 1001 1001 1001 1001 1001 1001 1001 1001 101   --&gt; 对于后三位：1001 最后一个1进位得到 101,即 101</span></span><br><span class="line">(<span class="number">0.2</span>).toString(<span class="number">2</span>)       <span class="comment">// 0.0011 0011 0011 0011 0011 0011 0011 0011 0011 0011 0011 0011 0011 01    --&gt; 对于后三位：0011 最后一个1进位得到 010,即 01</span></span><br><span class="line">(<span class="number">0.3</span>).toString(<span class="number">2</span>)       <span class="comment">// 0.0100 1100 1100 1100 1100 1100 1100 1100 1100 1100 1100 1100 1100 11    --&gt; 对于后三位：1100 最后两个0舍去得到 11</span></span><br><span class="line">(<span class="number">0.1</span> + <span class="number">0.2</span>).toString(<span class="number">2</span>) <span class="comment">// 0.0100 1100 1100 1100 1100 1100 1100 1100 1100 1100 1100 1100 1101       --&gt; 转换为十进制为 0.30000000000000004</span></span><br></pre></td></tr></table></figure>

<p>小数转换二进制时的无限循环不可避免。所以我有个想法就是将其转换为字符串，然后按小数点分割成两部分，每部分都一位一位算，最后再将两部分和小数点拼接起来，因为计算的时候都是18以内（为何是18？单位最大为9，9 + 9 = 18）的整数加减法，所以这样可以避免因为小数转二进制而造成的误差。下一节，详细介绍一下这个思路的实现过程。</p>
<h2 id="大数运算（浮点数运算）"><a href="#大数运算（浮点数运算）" class="headerlink" title="大数运算（浮点数运算）"></a>大数运算（浮点数运算）</h2><p>现在我们详细介绍一下上一节所说的思路的实现过程。首先我们看加法。</p>
<h3 id="大数加法"><a href="#大数加法" class="headerlink" title="大数加法"></a>大数加法</h3><p>在开始以前，我们先做一些准备，考虑一下都有哪些可能性，以及可能出现的BUG。</p>
<h4 id="符号及NaN"><a href="#符号及NaN" class="headerlink" title="符号及NaN"></a>符号及NaN</h4><p>先写一个简单的<code>add(x, y)</code>方法。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> add = <span class="function">(<span class="params">x, y</span>) =&gt;</span> x + y</span><br></pre></td></tr></table></figure>

<p>通过传不同的参数，可能会出现以下几种情况：</p>
<ol>
<li>传入两个非负数，正常计算；</li>
<li>一正一负，加法变减法；</li>
<li>均为负数，绝对值加法运算，然后取负；</li>
<li>一个或多个为非数字，即为NaN，会导致结果出错；</li>
<li>一个或多个为Boolean类型或者null时，需先转换为其对应的数值再进行计算；</li>
</ol>
<p>然后我们在add方法里面处理一下这几种情况。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * @param &#123;String&#125; x </span></span><br><span class="line"><span class="comment"> * @param &#123;String&#125; y </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> add = <span class="function">(<span class="params">x = <span class="string">''</span>, y = <span class="string">''</span></span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">Number</span>.isNaN(<span class="built_in">Number</span>(x)) || <span class="built_in">Number</span>.isNaN(<span class="built_in">Number</span>(y))) <span class="keyword">return</span> x + y <span class="comment">// 当一个或多个为非数字，直接拼接字符串</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> x === <span class="string">'boolean'</span> || x === <span class="literal">null</span>) x = <span class="built_in">Number</span>(x).toString() <span class="comment">// 当x为boolean类型或者null时，转换为其对应的数值</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> y === <span class="string">'boolean'</span> || y === <span class="literal">null</span>) y = <span class="built_in">Number</span>(y).toString() <span class="comment">// 当y为boolean类型或者null时，转换为其对应的数值</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> calMethood = <span class="literal">true</span> <span class="comment">// 运算方式，true为加法运算，false为减法运算（一正一负时需要减法运算）</span></span><br><span class="line">	<span class="keyword">let</span> allAegative = <span class="literal">false</span> <span class="comment">// 是否需要给结果添加负号，true需要，false不需要</span></span><br><span class="line">    <span class="keyword">let</span> sum = <span class="string">''</span> <span class="comment">// 和，字符串加减，所以定义为空串</span></span><br><span class="line">    <span class="keyword">let</span> flag = <span class="number">0</span> <span class="comment">// 进位标志，加法：当当前位计算大于9时，需要进位，加法进位只可能为0或1，减法：当当前位计算被减数不够减时，需要借位，减法借位只可能为0或-1</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 为了方便一正一负时的减法计算，将x和y存为默认的减数与被减数</span></span><br><span class="line">	<span class="keyword">let</span> subtracted = x <span class="comment">// 被减数，默认为x</span></span><br><span class="line">	<span class="keyword">let</span> minus = y <span class="comment">// 减数，默认为y</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (x.includes(<span class="string">'-'</span>) &amp;&amp; y.includes(<span class="string">'-'</span>)) &#123; <span class="comment">// 全是负数时，计算方法同全正数计算，只需要在最后的结果将负号加上即可，所以在此处将负号删去</span></span><br><span class="line">		allAegative = <span class="literal">true</span></span><br><span class="line">		calMethood = <span class="literal">true</span></span><br><span class="line">		subtracted = x.split(<span class="string">'-'</span>)[<span class="number">1</span>]</span><br><span class="line">		minus = y.split(<span class="string">'-'</span>)[<span class="number">1</span>]</span><br><span class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span> (x.includes(<span class="string">'-'</span>) || y.includes(<span class="string">'-'</span>)) &#123; <span class="comment">// x为负数或y为负数时,执行减法运算,绝对值小的为减数</span></span><br><span class="line">        <span class="comment">// 减法运算总是大的减小的</span></span><br><span class="line">		calMethood = <span class="literal">false</span></span><br><span class="line">		<span class="keyword">let</span> tempX = x.split(<span class="string">'-'</span>)[<span class="number">0</span>] ? x.split(<span class="string">'-'</span>)[<span class="number">0</span>] : x.split(<span class="string">'-'</span>)[<span class="number">1</span>]</span><br><span class="line">		<span class="keyword">let</span> tempY = y.split(<span class="string">'-'</span>)[<span class="number">0</span>] ? y.split(<span class="string">'-'</span>)[<span class="number">0</span>] : y.split(<span class="string">'-'</span>)[<span class="number">1</span>]</span><br><span class="line">		<span class="keyword">if</span> (+tempX &gt; +tempY) &#123;</span><br><span class="line">			subtracted = tempX</span><br><span class="line">			minus = tempY</span><br><span class="line">            allAegative = x.includes(<span class="string">'-'</span>)</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123; <span class="comment">// 默认为x - y，如果改为y - x需要给结果添加负号</span></span><br><span class="line">			subtracted = tempY</span><br><span class="line">			minus = tempX</span><br><span class="line">            allAegative = y.includes(<span class="string">'-'</span>)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// todo：计算过程</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Number</span>(x) + <span class="built_in">Number</span>(y)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="核心计算过程"><a href="#核心计算过程" class="headerlink" title="核心计算过程"></a>核心计算过程</h4><p>处理完了符号，以及可能出现的报错，下面就开始计算部分了。这里采用的是先将字符串用split转换为数组，然后反转数组，使得数组从第零位到最后一位分别对应数字的个位到最大位，最后一位一位计算得到结果。可以写一个方法用来计算。整个实现过程也非常简单</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 数组求和</span></span><br><span class="line"><span class="comment"> * @param &#123;Array&#125; arr1 被减数转换的数组</span></span><br><span class="line"><span class="comment"> * @param &#123;Array&#125; arr2 减数转换的数组</span></span><br><span class="line"><span class="comment"> * @param &#123;String&#125; sum 和</span></span><br><span class="line"><span class="comment"> * @param &#123;Number&#125; flag 进位标志</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> arrSum = (arr1, arr2, sum, flag) &#123;</span><br><span class="line">    <span class="comment">// 以位数大的数的长度为标准遍历，其中用到的未定义变量均为上一节中定义的变量</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="built_in">Math</span>.max(arr1.length, arr2.length); i ++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (calMethood) &#123; <span class="comment">// 加法</span></span><br><span class="line">            <span class="comment">// 当前位计算，没有则为0，同时加上进位</span></span><br><span class="line">            <span class="keyword">const</span> temp = (+arr1[i] || <span class="number">0</span>) + (+arr2[i] || <span class="number">0</span>) + flag</span><br><span class="line">            <span class="keyword">if</span> (temp &lt; <span class="number">10</span>) &#123; <span class="comment">// 判断是否需要进位</span></span><br><span class="line">                sum = <span class="string">`<span class="subst">$&#123;temp&#125;</span><span class="subst">$&#123;sum&#125;</span>`</span></span><br><span class="line">                flag = <span class="number">0</span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                sum = <span class="string">`<span class="subst">$&#123;temp - <span class="number">10</span>&#125;</span><span class="subst">$&#123;sum&#125;</span>`</span></span><br><span class="line">                flag = <span class="number">1</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123; <span class="comment">// 减法</span></span><br><span class="line">            <span class="keyword">let</span> temp = (arr1[i] || <span class="number">0</span>) - (arr2[i] || <span class="number">0</span>) + flag</span><br><span class="line">            <span class="keyword">if</span> ((+arr1[i] || <span class="number">0</span>) &lt; (+arr2[i] || <span class="number">0</span>)) &#123; <span class="comment">// 被减数太小,需要借位</span></span><br><span class="line">                temp += <span class="number">10</span></span><br><span class="line">                flag = <span class="number">-1</span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                flag = <span class="number">0</span></span><br><span class="line">            &#125;</span><br><span class="line">            sum = <span class="string">`<span class="subst">$&#123;temp&#125;</span><span class="subst">$&#123;sum&#125;</span>`</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 返回flag是为了判断是否有溢出的进位</span></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        sum,</span><br><span class="line">        flag,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后我们在添加一下字符串转换数组的过程。需要注意的是，我们需要特殊考虑一下小数，因为小数的字符串在分割时会将小数点也作为一位分割，所以我们先按小数点分割，将字符串分割为整数和小数两部分。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> integerA = subtracted.split(<span class="string">'.'</span>)[<span class="number">0</span>].split(<span class="string">''</span>).reverse() <span class="comment">// 被减数的整数部分的反转数组，方便遍历时从个位开始计算</span></span><br><span class="line"><span class="keyword">let</span> decimalA = [] <span class="comment">// 被减数的小数部分的反转数组</span></span><br><span class="line"><span class="keyword">let</span> integerB = minus.split(<span class="string">'.'</span>)[<span class="number">0</span>].split(<span class="string">''</span>).reverse() <span class="comment">// 减数的整数部分的反转数组</span></span><br><span class="line"><span class="keyword">let</span> decimalB = [] <span class="comment">// 减数的小数部分的反转数组</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (x.includes(<span class="string">'.'</span>)) &#123; <span class="comment">// 是小数再去计算小数部分的数组</span></span><br><span class="line">    decimalA = subtracted.split(<span class="string">'.'</span>)[<span class="number">1</span>].split(<span class="string">''</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (y.includes(<span class="string">'.'</span>)) &#123;</span><br><span class="line">    decimalB = minus.split(<span class="string">'.'</span>)[<span class="number">1</span>].split(<span class="string">''</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 根据小数的特殊性，需要根据两个数字的最长长度去给另一个填充0</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="built_in">Math</span>.max(decimalA.length, decimalB.length); i ++) &#123;</span><br><span class="line">    decimalA[i] = +decimalA[i] || <span class="number">0</span></span><br><span class="line">    decimalB[i] = +decimalB[i] || <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line">decimalA = decimalA.reverse()</span><br><span class="line">decimalB = decimalB.reverse()</span><br></pre></td></tr></table></figure>

<p>然后进行计算，先算小数后算整数</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">decimalA = decimalA.reverse()</span><br><span class="line">decimalB = decimalB.reverse()</span><br><span class="line"><span class="keyword">const</span> decimalAns = arrSum(decimalA, decimalB, sum, flag)</span><br><span class="line">sum = decimalAns.sum.replace(<span class="regexp">/0*$/</span>, <span class="string">''</span>) <span class="comment">// 去除小数部分末尾的0</span></span><br><span class="line">flag = decimalAns.flag</span><br><span class="line"></span><br><span class="line"><span class="comment">// 小数部分计算不为空,则添加小数点</span></span><br><span class="line"><span class="keyword">if</span> (sum !== <span class="string">''</span>) sum = <span class="string">`.<span class="subst">$&#123;sum&#125;</span>`</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> integerAns = arrSum(integerA, integerB, sum, flag)</span><br><span class="line">sum = integerAns.sum</span><br><span class="line">flag = integerAns.flag</span><br><span class="line"><span class="comment">// 进位溢出，前面再添加一位</span></span><br><span class="line"><span class="keyword">if</span> (flag !== <span class="number">0</span>) &#123;</span><br><span class="line">    sum = <span class="string">`<span class="subst">$&#123;flag&#125;</span><span class="subst">$&#123;sum&#125;</span>`</span></span><br><span class="line">&#125;</span><br><span class="line">sum = sum.replace(<span class="regexp">/^0*/</span>, <span class="string">''</span>) <span class="comment">// 去除最左侧的0</span></span><br></pre></td></tr></table></figure>

<p>然后最后只需要将最后的sum和符号拼起来就是最终的结果。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">return</span> allAegative ? <span class="string">`-<span class="subst">$&#123;sum&#125;</span>`</span> : sum</span><br></pre></td></tr></table></figure>

<h3 id="大数减法"><a href="#大数减法" class="headerlink" title="大数减法"></a>大数减法</h3><p>减法与加法类似，且在上面的过程中，已经有了一个雏形。<br>比如说 <code>x - y</code>可以看成是 <code>x + (-y)</code>，所以就有了一个思路是，增加一个参数用来判断是否是减法，如果是减法就给y值取反，然后仍然进行加法运算。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * @param &#123;Number&#125; x </span></span><br><span class="line"><span class="comment"> * @param &#123;Number&#125; y </span></span><br><span class="line"><span class="comment"> * @param &#123;String&#125; methood </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> add = <span class="function">(<span class="params">x, y, methood = <span class="string">'+'</span></span>) =&gt;</span> &#123;</span><br><span class="line">    y = methood === <span class="string">'-'</span> ? -y : y</span><br><span class="line">    <span class="keyword">return</span> x + y</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">add(<span class="number">2</span>, <span class="number">3</span>) <span class="comment">// 5</span></span><br><span class="line">add(<span class="number">2</span>, <span class="number">3</span>, <span class="string">'-'</span>) <span class="comment">// -1</span></span><br><span class="line">add(<span class="number">2</span>, <span class="number">-3</span>, <span class="string">'-'</span>) <span class="comment">// 5</span></span><br></pre></td></tr></table></figure>

<p>参照这个思路，我们可以在已经写好的加法上稍作改造，加以下几行代码。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * @param &#123;String&#125; x </span></span><br><span class="line"><span class="comment"> * @param &#123;String&#125; y </span></span><br><span class="line"><span class="comment"> * @param &#123;String&#125; methood </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> add = <span class="function">(<span class="params">x = <span class="string">''</span>, y = <span class="string">''</span>, methood = <span class="string">'+'</span></span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (methood === <span class="string">'-'</span>) &#123;</span><br><span class="line">		b = b.includes(<span class="string">'-'</span>) ? b.split(<span class="string">'-'</span>)[<span class="number">1</span>] : <span class="string">`-<span class="subst">$&#123;b&#125;</span>`</span></span><br><span class="line">	&#125;</span><br><span class="line">    <span class="comment">// ---</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>市面上已经有非常成熟的解决方案了，我这就是属于重复造轮子了，纯当学习.</p>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a href="https://baike.baidu.com/item/%E5%8F%8C%E7%B2%BE%E5%BA%A6%E6%B5%AE%E7%82%B9%E6%95%B0" target="_blank" rel="noopener">双精度浮点数</a><br><a href="https://www.ecma-international.org/ecma-262/6.0/#sec-number.prototype.tofixed" target="_blank" rel="noopener">ECMAScript (ECMA-262)</a></p>
<h1 id="源码"><a href="#源码" class="headerlink" title="源码"></a>源码</h1><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 计算大数</span></span><br><span class="line"><span class="comment"> * @param &#123;String&#125; a </span></span><br><span class="line"><span class="comment"> * @param &#123;String&#125; b </span></span><br><span class="line"><span class="comment"> * @param &#123;String&#125; mthood 运算方式 </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> addLargeNumber = <span class="function">(<span class="params">a = <span class="string">''</span>, b = <span class="string">''</span>, methood = <span class="string">'+'</span></span>) =&gt;</span> &#123;</span><br><span class="line">	<span class="comment">// 传小数进行计算在toString的时候就会丢失精度，太大的时候一拿到就已经没有精度了。。</span></span><br><span class="line">	<span class="keyword">if</span> (<span class="built_in">Number</span>.isNaN(<span class="built_in">Number</span>(a)) || <span class="built_in">Number</span>.isNaN(<span class="built_in">Number</span>(b))) <span class="keyword">return</span> a + b</span><br><span class="line">	<span class="keyword">if</span> (methood === <span class="string">'-'</span>) &#123;</span><br><span class="line">		b = b.includes(<span class="string">'-'</span>) ? b.split(<span class="string">'-'</span>)[<span class="number">1</span>] : <span class="string">`-<span class="subst">$&#123;b&#125;</span>`</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">let</span> calMethood = <span class="literal">true</span> <span class="comment">// 运算方式,true为加法运算,false为减法运算</span></span><br><span class="line">	<span class="keyword">let</span> allAegative = <span class="literal">false</span> <span class="comment">// 是否需要加负号</span></span><br><span class="line">	<span class="keyword">let</span> subtracted = a <span class="comment">// 被减数,默认为a</span></span><br><span class="line">	<span class="keyword">let</span> minus = b <span class="comment">// 减数,默认为b</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (a.includes(<span class="string">'-'</span>) &amp;&amp; b.includes(<span class="string">'-'</span>)) &#123; <span class="comment">// 全是负数时，计算方法同全正数计算，只需要在最后的结果将负号加上即可，所以在此处将负号删去</span></span><br><span class="line">		allAegative = <span class="literal">true</span></span><br><span class="line">		calMethood = <span class="literal">true</span></span><br><span class="line">		subtracted = a.split(<span class="string">'-'</span>)[<span class="number">1</span>]</span><br><span class="line">		minus = b.split(<span class="string">'-'</span>)[<span class="number">1</span>]</span><br><span class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span> (a.includes(<span class="string">'-'</span>) || b.includes(<span class="string">'-'</span>)) &#123; <span class="comment">// a为负数或b为负数时,执行减法运算,绝对值小的为减数</span></span><br><span class="line">		<span class="comment">// 减法运算总是大的减小的</span></span><br><span class="line">		calMethood = <span class="literal">false</span></span><br><span class="line">		<span class="keyword">let</span> tempX = a.split(<span class="string">'-'</span>)[<span class="number">0</span>] ? a.split(<span class="string">'-'</span>)[<span class="number">0</span>] : a.split(<span class="string">'-'</span>)[<span class="number">1</span>]</span><br><span class="line">		<span class="keyword">let</span> tempY = b.split(<span class="string">'-'</span>)[<span class="number">0</span>] ? b.split(<span class="string">'-'</span>)[<span class="number">0</span>] : b.split(<span class="string">'-'</span>)[<span class="number">1</span>]</span><br><span class="line">		<span class="built_in">console</span>.log(+tempX, +tempY, +tempX &gt; +tempY)</span><br><span class="line">		<span class="keyword">if</span> (+tempX &gt; +tempY) &#123;</span><br><span class="line">			subtracted = tempX</span><br><span class="line">			minus = tempY</span><br><span class="line">            allAegative = a.includes(<span class="string">'-'</span>)</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123; <span class="comment">// 默认为x - y，如果改为y - x需要给结果添加负号</span></span><br><span class="line">			subtracted = tempY</span><br><span class="line">			minus = tempX</span><br><span class="line">            allAegative = b.includes(<span class="string">'-'</span>)</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">    <span class="keyword">let</span> integerA = subtracted.split(<span class="string">'.'</span>)[<span class="number">0</span>].split(<span class="string">''</span>).reverse() <span class="comment">// 被减数的整数部分的反转数组，方便遍历时从个位开始计算</span></span><br><span class="line">    <span class="keyword">let</span> decimalA = [] <span class="comment">// 被减数的小数部分的反转数组</span></span><br><span class="line">    <span class="keyword">let</span> integerB = minus.split(<span class="string">'.'</span>)[<span class="number">0</span>].split(<span class="string">''</span>).reverse() <span class="comment">// 减数的整数部分的反转数组</span></span><br><span class="line">	<span class="keyword">let</span> decimalB = [] <span class="comment">// 减数的小数部分的反转数组</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="keyword">let</span> flag = <span class="number">0</span> <span class="comment">// 进位标志，当当前位计算大于9时，需要进位，加法进位只可能为0或1</span></span><br><span class="line">	<span class="keyword">let</span> sum = <span class="string">''</span> <span class="comment">// 和</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (a.includes(<span class="string">'.'</span>)) &#123; <span class="comment">// 是小数再去计算小数部分的数组</span></span><br><span class="line">		decimalA = subtracted.split(<span class="string">'.'</span>)[<span class="number">1</span>].split(<span class="string">''</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (b.includes(<span class="string">'.'</span>)) &#123;</span><br><span class="line">		decimalB = minus.split(<span class="string">'.'</span>)[<span class="number">1</span>].split(<span class="string">''</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="comment">// 根据小数的特殊性，需要根据两个数字的最长长度去给另一个填充0</span></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="built_in">Math</span>.max(decimalA.length, decimalB.length); i ++) &#123;</span><br><span class="line">		decimalA[i] = +decimalA[i] || <span class="number">0</span></span><br><span class="line">		decimalB[i] = +decimalB[i] || <span class="number">0</span></span><br><span class="line">	&#125;</span><br><span class="line">	decimalA = decimalA.reverse()</span><br><span class="line">	decimalB = decimalB.reverse()</span><br><span class="line">	<span class="keyword">const</span> decimalAns = arrSum(decimalA, decimalB, sum, flag)</span><br><span class="line">	sum = decimalAns.sum.replace(<span class="regexp">/0*$/</span>, <span class="string">''</span>) <span class="comment">// 去除小数部分末尾的0</span></span><br><span class="line">	flag = decimalAns.flag</span><br><span class="line">	<span class="comment">// 小数部分计算不为空,则添加小数点</span></span><br><span class="line">	<span class="keyword">if</span> (sum !== <span class="string">''</span>) sum = <span class="string">`.<span class="subst">$&#123;sum&#125;</span>`</span></span><br><span class="line">	<span class="keyword">const</span> integerAns = arrSum(integerA, integerB, sum, flag)</span><br><span class="line">	sum = integerAns.sum</span><br><span class="line">	flag = integerAns.flag</span><br><span class="line">	<span class="keyword">if</span> (flag !== <span class="number">0</span>) &#123;</span><br><span class="line">		sum = <span class="string">`<span class="subst">$&#123;flag&#125;</span><span class="subst">$&#123;sum&#125;</span>`</span></span><br><span class="line">	&#125;</span><br><span class="line">	sum = sum.replace(<span class="regexp">/^0*/</span>, <span class="string">''</span>) || <span class="string">'0'</span> <span class="comment">// 去除最左侧的0，同时避免因结果是0而产生空串</span></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * </span></span><br><span class="line"><span class="comment">	 * @param &#123;Array&#125; arr1 被减数转换的数组</span></span><br><span class="line"><span class="comment">	 * @param &#123;Array&#125; arr2 减数转换的数组</span></span><br><span class="line"><span class="comment">	 * @param &#123;String&#125; sum 和</span></span><br><span class="line"><span class="comment">	 * @param &#123;Number&#125; flag 进位标志</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">arrSum</span>(<span class="params">arr1, arr2, sum, flag</span>) </span>&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="built_in">Math</span>.max(arr1.length, arr2.length); i ++) &#123;</span><br><span class="line">			<span class="keyword">if</span> (calMethood) &#123; <span class="comment">// 加法</span></span><br><span class="line">				<span class="keyword">const</span> temp = (+arr1[i] || <span class="number">0</span>) + (+arr2[i] || <span class="number">0</span>) + flag</span><br><span class="line">				<span class="keyword">if</span> (temp &lt; <span class="number">10</span>) &#123;</span><br><span class="line">					sum = <span class="string">`<span class="subst">$&#123;temp&#125;</span><span class="subst">$&#123;sum&#125;</span>`</span></span><br><span class="line">					flag = <span class="number">0</span></span><br><span class="line">				&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">					sum = <span class="string">`<span class="subst">$&#123;temp - <span class="number">10</span>&#125;</span><span class="subst">$&#123;sum&#125;</span>`</span></span><br><span class="line">					flag = <span class="number">1</span></span><br><span class="line">				&#125;</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123; <span class="comment">// 减法</span></span><br><span class="line">				<span class="keyword">let</span> temp = (+arr1[i] || <span class="number">0</span>) - (+arr2[i] || <span class="number">0</span>) + flag</span><br><span class="line">				<span class="keyword">if</span> ((arr1[i] || <span class="number">0</span>) &lt; (arr2[i] || <span class="number">0</span>)) &#123; <span class="comment">// 被减数太小,需要借位</span></span><br><span class="line">					temp += <span class="number">10</span></span><br><span class="line">					flag = <span class="number">-1</span></span><br><span class="line">				&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">					flag = <span class="number">0</span></span><br><span class="line">				&#125;</span><br><span class="line">				sum = <span class="string">`<span class="subst">$&#123;temp&#125;</span><span class="subst">$&#123;sum&#125;</span>`</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> &#123;</span><br><span class="line">			sum,</span><br><span class="line">			flag,</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> allAegative ? <span class="string">`-<span class="subst">$&#123;sum&#125;</span>`</span> : sum</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">JaCo Wu</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://jacokwu.cn/blog/2020/06/13/JS大数运算与精度/">https://jacokwu.cn/blog/2020/06/13/JS大数运算与精度/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://jacokwu.cn/blog">JaCo Wu的博客</a>！</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/blog/tags/es6/">es6</a><a class="post-meta__tags" href="/blog/tags/原生/">原生</a></div><nav id="pagination"><div class="prev-post pull-left"><a href="/blog/2020/06/15/Linux搭建服务器/"><i class="fa fa-chevron-left">  </i><span>Linux搭建服务器</span></a></div><div class="next-post pull-right"><a href="/blog/2020/06/09/JS位运算符/"><span>JS位运算符</span><i class="fa fa-chevron-right"></i></a></div></nav><div id="gitalk-container"></div><script>var gitalk = new Gitalk({
  clientID: '49402195632a617e3708',
  clientSecret: '887d4bded9e50678007602a209d9191c8e2d8dbf',
  repo: 'blog',
  owner: 'JaCoxxx',
  admin: 'JaCoxxx',
  id: md5(decodeURI(location.pathname)),
  language: 'zh-CN'
})
gitalk.render('gitalk-container')</script></div></div><footer class="footer-bg" style="background-image: url(https://jacokwu.cn/images/public/background.png)"><div class="layout" id="footer"><div class="copyright">&copy;2019 - 2020 By JaCo Wu</div><div class="framework-info"><span>驱动 - </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file-o"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/blog/js/utils.js?version=1.6.1"></script><script src="/blog/js/fancybox.js?version=1.6.1"></script><script src="/blog/js/sidebar.js?version=1.6.1"></script><script src="/blog/js/copy.js?version=1.6.1"></script><script src="/blog/js/fireworks.js?version=1.6.1"></script><script src="/blog/js/transition.js?version=1.6.1"></script><script src="/blog/js/scroll.js?version=1.6.1"></script><script src="/blog/js/head.js?version=1.6.1"></script><script src="/blog/js/search/local-search.js"></script><script>if(/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
}</script><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章"></div></div></div><hr><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a href="https://github.com/wzpan/hexo-generator-search" style="color:#49B1F5;">hexo-generator-search</a>
 <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div></body></html>